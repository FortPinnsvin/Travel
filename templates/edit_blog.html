<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Story Updating</title>
    <link href="../../css/bootstrap.min.css" rel="stylesheet">
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="../../js/bootstrap.min.js"></script>
</head>
<body>

<!-- Static navbar -->
<div class="navbar navbar-default">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../">yo-journey</a>
        <a class="navbar-brand" href="/user/{{ .user.Id }}"><img src="{{ .user.Avatar }}" height="150%" style="margin-top:-5px;"/>
            {{ .user.FirstName }} {{ .user.LastName}}</a>
    </div>
    <div class="navbar-collapse collapse navbar-responsive-collapse">
        <ul class="nav navbar-nav">
            <li><a href="/">Home</a></li>
            <li><a href="/friends">Friends</a></li>
            <li><a href="/feed">Feed</a></li>
            <li><a href="/advice/country">Advices</a></li>
            <li><a href="/mini_blog_list">Stories</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
            <li><a href="/logout">Log Out!</a></li>
        </ul>
        <form class="navbar-form navbar-left" action="../search" method="get">
            <input type="text" class="form-control col-lg-8" placeholder="Search User" name="q">
        </form>
    </div>

</div>

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div class="well well-sm">
                <div class="form-horizontal">
                    <div class="alert alert-dismissable alert-info" style="display:none;" id="tooltip">
                        <button type="button" class="close" data-dismiss="alert">Ã—</button>
                        <strong>All good!</strong> Album is updated!
                    </div>
                    <fieldset>
                        <legend>Update your story:</legend>
                        <div class="form-group">
                            <div class="col-md-10 col-md-offset-1">
                                <label for="title">Title:</label>
                                <input id="title" name="title" type="text" placeholder="{{.blog.Name}}"
                                       class="form-control" value="{{.blog.Name}}">
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="col-md-12 text-center">
                                <button class="btn btn-info" onclick="post()">Save</button>

                                <a href="../../album/{{ .album_id }}/settings">
                                    <button class="btn btn-danger" type="submit">Cancel</button>
                                </a>
                            </div>
                        </div>

                    </fieldset>
                </div>
            </div>
        </div>
    </div>

    <hr>
    <footer>
        <div class="row">
            <div class="col-lg-12">
                <p><strong>yo-journey, 2014.</strong> Made by <a href="">Alex Saskevich</a> and <a href="">Danik
                    Tsyrkunov</a>.</p>
            </div>
        </div>

    </footer>

</div>

</body>
</html>
<script>
    var post = function () {
        $.ajax({
            type: "POST",
            url: "../../mini_blog/{{ .blog.Id }}/edit",
            data: getParams("title"),
            success: function (msg) {
                var rdr = JSON.parse(msg)
                console.log(rdr)
                if (rdr.error == 0) {
                    var form = document.getElementById("tooltip")
                    form.style.display = ""
                    setInterval(function () {
                        form.style.display = "none"
                        window.location.href = "/mini_blog/{{ .blog.Id }}"
                    }, 2000)
                }
            }
        });
    }

    var getParams = function (id) {
        return $('#' + id).attr('name') + "=" + $('#' + id).val() + "&"
    }

</script>